(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function s(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(e){if(e.ep)return;e.ep=!0;const t=s(e);fetch(e.href,t)}})();const L=()=>{const o=document.getElementById("logout-button");o&&o.addEventListener("click",function(){console.log("Logout button clicked"),localStorage.clear(),sessionStorage.clear(),window.location.pathname.endsWith("/index.html")||window.location.pathname==="/"?window.location.reload():window.location.href="../../index.html"})};async function E(){if(!document.body.classList.contains("create-listing-page"))return;const o=localStorage.getItem("token"),n=localStorage.getItem("api_key"),s=document.getElementById("new-listing-form"),i=document.getElementById("new-listing-title"),e=document.getElementById("new-listing-description"),t=document.getElementById("new-listing-category"),r=document.getElementById("new-listing-image"),d=document.getElementById("new-listing-ends-at"),u=document.getElementById("new-listing-button");if(!s||!i||!e||!t||!r||!u||!d){console.error("Required input or button elements are missing.");return}u.addEventListener("click",async p=>{console.log("New listing button clicked."),p.preventDefault();const c=i.value.trim(),g=e.value.trim(),m=t.value.trim(),f=r.value.trim(),y=d.value.trim();if(!c||!g||!m||!f||!y){alert("Please fill in all fields correctly."),console.error("One or more fields are empty or invalid.");return}try{const a=new Headers({"Content-Type":"application/json","X-Noroff-API-Key":n,Authorization:`Bearer ${o}`}),w=JSON.stringify({title:c,description:g,tags:m,media:[{url:f,alt:c}],endsAt:y});console.log("Request Payload:",w);const l=await fetch("https://v2.api.noroff.dev/auction/listings",{method:"POST",headers:a,body:w});if(!l.ok)throw new Error(`New listing request failed: ${l.status} ${l.statusText}`);const h=await l.json();console.log("New listing created successfully:",h),alert("New listing created successfully!")}catch(a){console.error("Error creating new listing:",a.message),alert("Failed to create new listing.")}})}function v(o){const n=document.getElementById(o);n&&n.classList.toggle("hidden")}document.addEventListener("DOMContentLoaded",function(){L(),E(),console.log("dropdown loaded");const o=document.getElementById("dropdownButton");o&&o.addEventListener("click",function(){v("dropdownMenuBottom")});const n=localStorage.getItem("username");if(n){const s=n.replace(/['"]+/g,""),i=document.querySelector(".logged-in-username");i&&(i.textContent="Hello, "+s+"! You are currently logged in.");const e=document.querySelector(".visible-if-logged-in");e&&(e.style.display="block")}});
