const B=()=>{const e=document.getElementById("logout-button");e&&e.addEventListener("click",function(){console.log("Logout button clicked"),localStorage.clear(),sessionStorage.clear(),window.location.pathname.endsWith("/index.html")||window.location.pathname==="/"?window.location.reload():window.location.href="../../index.html"})};async function L(){if(!document.body.classList.contains("create-listing-page"))return;const e=localStorage.getItem("token"),t=localStorage.getItem("api_key"),s=document.getElementById("new-listing-form"),n=document.getElementById("new-listing-title"),o=document.getElementById("new-listing-description"),r=document.getElementById("new-listing-category"),a=document.getElementById("new-listing-image"),d=document.getElementById("new-listing-ends-at"),g=document.getElementById("new-listing-button");if(!s||!n||!o||!r||!a||!g||!d){console.error("Required input or button elements are missing.");return}g.addEventListener("click",async p=>{console.log("New listing button clicked."),p.preventDefault();const l=n.value.trim(),u=o.value.trim(),m=r.value.trim(),w=a.value.trim(),y=d.value.trim();if(!l||!u||!m||!w||!y){alert("Please fill in all fields correctly."),console.error("One or more fields are empty or invalid.");return}try{const c=new Headers({"Content-Type":"application/json","X-Noroff-API-Key":t,Authorization:`Bearer ${e}`}),f=JSON.stringify({title:l,description:u,tags:m,media:[{url:w,alt:l}],endsAt:y});console.log("Request Payload:",f);const i=await fetch("https://v2.api.noroff.dev/auction/listings",{method:"POST",headers:c,body:f});if(!i.ok)throw new Error(`New listing request failed: ${i.status} ${i.statusText}`);const E=await i.json();console.log("New listing created successfully:",E),alert("New listing created successfully!")}catch(c){console.error("Error creating new listing:",c.message),alert("Failed to create new listing.")}})}function v(e){const t=document.getElementById(e);t&&t.classList.toggle("hidden")}document.addEventListener("DOMContentLoaded",function(){B(),L(),console.log("dropdown loaded");const e=document.getElementById("dropdownButton");e&&e.addEventListener("click",function(){v("dropdownMenuBottom")});const t=localStorage.getItem("username");if(t){const s=t.replace(/['"]+/g,""),n=document.querySelector(".logged-in-username");n&&(n.textContent="Hello, "+s+"! You are currently logged in.");const o=document.querySelector(".visible-if-logged-in");o&&(o.style.display="block")}});
